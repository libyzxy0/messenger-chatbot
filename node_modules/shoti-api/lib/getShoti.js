const getShoti = (obj) => {
	return new Promise((resolve, reject) => {
		const axios = require('axios');
        const auth = require('./auth.js');
		let isAuthenticated = auth.isAuthenticated(obj.api_key);
		if(isAuthenticated) {
			let ax = axios.get(`https://shoti.libyzxy0-dev.repl.co/api?apikey=${obj.api_key}&type=${obj.type}`);
			ax.then((response) => {
				resolve({
					url: response.data.response.url,
					shoti_id: response.data.response.id, 
					message: response.data.response.message,
                });
			})
			ax.catch((err) => {
				reject(err);
			}) 
		} else {
			let error = new Error({ code: 400, message: "Invalid apikey!" })
			reject(error)
		}
	})
}
module.exports = getShoti;